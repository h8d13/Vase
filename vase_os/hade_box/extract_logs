#!/bin/bash
# Debug helper. Gather link that is in response for clean log format. The same can be done with "cmd_history.txt and cmd_output.txt"

# Find the correct log path based on script location
script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
log_file="${script_dir}/logs/install.log"

if [ ! -f "$log_file" ]; then
    echo "[-] Error: No installer logs found"
    echo "    Expected: $log_file"
    exit 1
fi

mode="${1:-extract}"

case "$mode" in
    extract)
        echo "[+] Extracting installer logs from: $log_file"
        grep -iE 'INFO|error' "$log_file"
        ;;
    upload)
        echo "[+] Extracting installer logs from: $log_file"
        grep -iE 'INFO|error' "$log_file"
        echo ""
        echo "[+] Uploading logs to 0x0.st..."
        curl -F"file=@$log_file" https://0x0.st
        ;;
    *)
        echo "Usage: $0 {extract|upload}"
        exit 1
        ;;
esac 