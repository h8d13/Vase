#!/bin/bash
# Debug helper. Gather link that is in response for clean log format. The same can be done with "cmd_history.txt and cmd_output.txt"

# Find the correct log path based on script location
script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
log_file="${script_dir}/logs/install.log"
base_path="${script_dir}/logs/*"

if [ ! -f "$log_file" ]; then
    echo "[-] Error: No installer logs found"
    echo "    Expected: $log_file"
    exit 1
fi

mode="${1:-extract}"

case "$mode" in
    upload)
        echo "[+] Extracting full installer logs from: $log_file"
        echo "[+] Uploading logs to 0x0.st..."
        curl -F"file=@$log_file" https://0x0.st
        ;;
    full)
        echo "[+] Uploading full logs to 0x0.st..."
        (for f in $base_path; do echo "=== $f ==="; cat "$f"; echo; done) | curl -F"file=@-" https://0x0.st
        ;;
    *)
        echo "Usage: $0 {full|upload}"
        exit 1
        ;;
esac 