#!/bin/bash
. "$(dirname "$0")/../../util_f"
. "$(dirname "$0")/../../..."

# Verify and capture output
gpg_output=$(gpg --verify "${zl_d}/${vm_d}/${iso_n}.${iso_ext}.${iso_sig}" "${zl_d}/${vm_d}/${iso_n}.${iso_ext}" 2>&1)
exit_code=$?

# Display output
echo "$gpg_output"

# Return signature info for logging (on stdout, separate from gpg output)
if [ $exit_code -eq 0 ]; then
    echo "$gpg_output" | grep "^gpg:" | tr '\n' ' ' | tr -s ' '
fi

exit $exit_code